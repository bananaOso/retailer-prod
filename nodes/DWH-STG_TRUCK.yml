steps:
  STG_TRUCK-f33ee760-e8cd-4b43-b21f-d69b4dc31277:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: DWH
      materializationType: table
      metadata:
        appliedNodeTests:
          - continueOnFailure: true
            description: ""
            name: Special characters test
            runOrder: After
            templateString: |-
              select *
              from {{ref('DWH','STG_TRUCK')}}
              where REGEXP_LIKE(MAKE,'.*[^a-zA-Z0-9 ].*')
        columns:
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 842935d4-f857-4961-88b0-bddc06890e78
              stepCounter: f33ee760-e8cd-4b43-b21f-d69b4dc31277
            config: {}
            dataType: STRING
            description: ""
            name: COUNTRY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d5966ac8-bb13-4aab-b64c-6a43c2bde4e4
                    stepCounter: 9c01576e-f6e1-4621-8bbb-3744b18063a6
                transform: "\"TRUCK\".\"VALUE\":\"COUNTRY\"::STRING"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 40a2f939-97b3-46ac-933f-dd2f3b403239
              stepCounter: f33ee760-e8cd-4b43-b21f-d69b4dc31277
            config: {}
            dataType: DOUBLE
            description: ""
            name: EV_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d5966ac8-bb13-4aab-b64c-6a43c2bde4e4
                    stepCounter: 9c01576e-f6e1-4621-8bbb-3744b18063a6
                transform: "\"TRUCK\".\"VALUE\":\"EV_FLAG\"::DOUBLE"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 068ddba4-5972-4362-9f7d-409eb9db4e44
              stepCounter: f33ee760-e8cd-4b43-b21f-d69b4dc31277
            config: {}
            dataType: DOUBLE
            description: ""
            name: FRANCHISE_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d5966ac8-bb13-4aab-b64c-6a43c2bde4e4
                    stepCounter: 9c01576e-f6e1-4621-8bbb-3744b18063a6
                transform: "\"TRUCK\".\"VALUE\":\"FRANCHISE_FLAG\"::DOUBLE"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 01e0d5e6-a95c-4e97-b1d0-fed9e8183ce0
              stepCounter: f33ee760-e8cd-4b43-b21f-d69b4dc31277
            config: {}
            dataType: DOUBLE
            description: ""
            name: FRANCHISE_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d5966ac8-bb13-4aab-b64c-6a43c2bde4e4
                    stepCounter: 9c01576e-f6e1-4621-8bbb-3744b18063a6
                transform: "\"TRUCK\".\"VALUE\":\"FRANCHISE_ID\"::DOUBLE"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 0426447b-c0e9-4853-8281-ff4291fa8103
              stepCounter: f33ee760-e8cd-4b43-b21f-d69b4dc31277
            config: {}
            dataType: STRING
            description: ""
            name: ISO_COUNTRY_CODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d5966ac8-bb13-4aab-b64c-6a43c2bde4e4
                    stepCounter: 9c01576e-f6e1-4621-8bbb-3744b18063a6
                transform: "\"TRUCK\".\"VALUE\":\"ISO_COUNTRY_CODE\"::STRING"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 262f20d6-f39c-4338-8230-4c5dd13c29b5
              stepCounter: f33ee760-e8cd-4b43-b21f-d69b4dc31277
            config: {}
            dataType: STRING
            description: ""
            name: ISO_REGION
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d5966ac8-bb13-4aab-b64c-6a43c2bde4e4
                    stepCounter: 9c01576e-f6e1-4621-8bbb-3744b18063a6
                transform: "\"TRUCK\".\"VALUE\":\"ISO_REGION\"::STRING"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 20655a34-7430-4bd3-aa50-d46b2143f928
              stepCounter: f33ee760-e8cd-4b43-b21f-d69b4dc31277
            config: {}
            dataType: STRING
            description: ""
            name: MAKE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d5966ac8-bb13-4aab-b64c-6a43c2bde4e4
                    stepCounter: 9c01576e-f6e1-4621-8bbb-3744b18063a6
                transform: "{{revmoe_special_characters(\"TRUCK\".\"VALUE\":\"MAKE\"::STRING)}}"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 609de779-bf22-488a-affa-918cc3e24fa9
              stepCounter: f33ee760-e8cd-4b43-b21f-d69b4dc31277
            config: {}
            dataType: DOUBLE
            description: ""
            name: MENU_TYPE_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d5966ac8-bb13-4aab-b64c-6a43c2bde4e4
                    stepCounter: 9c01576e-f6e1-4621-8bbb-3744b18063a6
                transform: "\"TRUCK\".\"VALUE\":\"MENU_TYPE_ID\"::DOUBLE"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 5a360ad8-784b-46da-9b92-36959c833e2d
              stepCounter: f33ee760-e8cd-4b43-b21f-d69b4dc31277
            config: {}
            dataType: STRING
            description: ""
            name: MODEL
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d5966ac8-bb13-4aab-b64c-6a43c2bde4e4
                    stepCounter: 9c01576e-f6e1-4621-8bbb-3744b18063a6
                transform: "\"TRUCK\".\"VALUE\":\"MODEL\"::STRING"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: b25e963e-6d85-4b6a-95f1-2c10630c9437
              stepCounter: f33ee760-e8cd-4b43-b21f-d69b4dc31277
            config: {}
            dataType: STRING
            description: ""
            name: PRIMARY_CITY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d5966ac8-bb13-4aab-b64c-6a43c2bde4e4
                    stepCounter: 9c01576e-f6e1-4621-8bbb-3744b18063a6
                transform: "\"TRUCK\".\"VALUE\":\"PRIMARY_CITY\"::STRING"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 145b53a9-cbea-4349-9411-a9c027bf5902
              stepCounter: f33ee760-e8cd-4b43-b21f-d69b4dc31277
            config: {}
            dataType: STRING
            description: ""
            name: REGION
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d5966ac8-bb13-4aab-b64c-6a43c2bde4e4
                    stepCounter: 9c01576e-f6e1-4621-8bbb-3744b18063a6
                transform: "\"TRUCK\".\"VALUE\":\"REGION\"::STRING"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 35c98449-537f-4a1e-9b8f-58286e6886c7
              stepCounter: f33ee760-e8cd-4b43-b21f-d69b4dc31277
            config: {}
            dataType: DOUBLE
            description: ""
            name: TRUCK_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d5966ac8-bb13-4aab-b64c-6a43c2bde4e4
                    stepCounter: 9c01576e-f6e1-4621-8bbb-3744b18063a6
                transform: "\"TRUCK\".\"VALUE\":\"TRUCK_ID\"::DOUBLE"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: df5d6c5d-0f9f-467e-8f22-1c7407702387
              stepCounter: f33ee760-e8cd-4b43-b21f-d69b4dc31277
            config: {}
            dataType: DOUBLE
            description: ""
            name: TRUCK_OPENING_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d5966ac8-bb13-4aab-b64c-6a43c2bde4e4
                    stepCounter: 9c01576e-f6e1-4621-8bbb-3744b18063a6
                transform: "\"TRUCK\".\"VALUE\":\"TRUCK_OPENING_DATE\"::DOUBLE"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 043dfdba-bebb-4eb5-adab-32a07526c791
              stepCounter: f33ee760-e8cd-4b43-b21f-d69b4dc31277
            config: {}
            dataType: DOUBLE
            description: ""
            name: YEAR
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d5966ac8-bb13-4aab-b64c-6a43c2bde4e4
                    stepCounter: 9c01576e-f6e1-4621-8bbb-3744b18063a6
                transform: "\"TRUCK\".\"VALUE\":\"YEAR\"::DOUBLE"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 81827f85-6a29-4c72-857e-a7bae5c3581f
              stepCounter: f33ee760-e8cd-4b43-b21f-d69b4dc31277
            config: {}
            dataType: Number
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: TRUCK_AGE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: (YEAR(CURRENT_DATE())-"TRUCK"."YEAR")
            systemColumnType: None
            transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases: {}
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: DWH
                nodeName: TRUCK
            join:
              joinCondition: FROM {{ ref('DWH', 'TRUCK') }} "TRUCK"
            name: STG_TRUCK
            noLinkRefs: []
      name: STG_TRUCK
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: f33ee760-e8cd-4b43-b21f-d69b4dc31277
